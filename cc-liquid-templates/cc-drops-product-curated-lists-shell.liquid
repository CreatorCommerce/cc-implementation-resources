{%- comment -%}
  Products - Curated Lists Shell Section
  This shell section contains the schema and renders the base snippet with all settings as parameters
{%- endcomment -%}

{%- liquid
  assign cc_handle = cart.attributes['cc-creator-handle']
  assign cc_preview_creator = section.settings.preview_creator
  
  assign cc_creator = metaobject | default: metaobjects.creator[cc_handle]
  if cc_creator == blank and request.design_mode
    assign cc_creator = cc_preview_creator
  endif
-%}

{% render 'cc-drops-product-curated-list-base-snippet',
  tagline: section.settings.tagline,
  header: section.settings.header,
  header_max_width: section.settings.header_max_width,
  description_max_width: section.settings.description_max_width,
  description_display_style: section.settings.description_display_style,
  button_text: section.settings.button_text,
  no_drops_behavior: section.settings.no_drops_behavior,
  fallback_collection: section.settings.fallback_collection,
  products_to_show: section.settings.products_to_show,
  product_card_snippet: section.settings.product_card_snippet,
  product_card_border_radius: section.settings.product_card_border_radius,
  dropdown_border_width: section.settings.dropdown_border_width,
  dropdown_border_radius: section.settings.dropdown_border_radius,
  dropdown_border_color: section.settings.dropdown_border_color,
  content_alignment: section.settings.content_alignment,
  color_scheme: section.settings.color_scheme,
  columns_desktop: section.settings.columns_desktop,
  columns_mobile: section.settings.columns_mobile,
  grid_gap_desktop: section.settings.grid_gap_desktop,
  grid_gap_mobile: section.settings.grid_gap_mobile,
  padding_horizontal_desktop: section.settings.padding_horizontal_desktop,
  padding_horizontal_mobile: section.settings.padding_horizontal_mobile,
  padding_vertical: section.settings.padding_vertical,
  preview_creator: section.settings.preview_creator,
  custom_css: section.settings.custom_css,
  section_id: section.id,
  cc_creator: cc_creator,
  metaobject: metaobject
%}

{% schema %}
{
  "name": "Products - Curated Lists",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "The Curated Lists Block",
      "info": "The Curated Lists Block displays curated product lists from your creators in an elegant, switchable grid. Each creator can have multiple 'drops' (collections of products), and customers can seamlessly toggle between them using a dropdown selector. This section is perfect for showcasing expert recommendations, themed bundles, or seasonal collections—all with one-click 'Add Bundle to Cart' functionality that makes purchasing effortless."
    },
    {
      "type": "header",
      "content": "Before Building",
      "info": "Make sure a page template exists for the Creator metaobject. Add this section to the Creator metaobject page template, and review the product card and potentially paste in a new snippet. Ensure your creator has drops configured with products assigned. The section will automatically pull in all drops and their associated products from the metaobject data."
    },
    {
      "type": "header",
      "content": "For Testing",
      "info": "To test, preview the theme with the section (saves the preview cookie). Then click the creator's affiliate link—but first ensure that creator is in a live campaign redirecting to the page with this section. You should then see the co-branded context with their drops displayed. Switch between drops using the dropdown to test the product grid switching functionality."
    },
    {
      "type": "header",
      "content": "Content & Text",
      "info": "Configure all text elements, messaging, and content for your drops section"
    },
    {
      "type": "richtext",
      "id": "tagline",
      "label": "Tagline",
      "default": "<p>EXPERT RECOMMENDATIONS</p>",
      "info": "Small uppercase text displayed above the main heading. Supports dynamic text: use [cc-creator-first-name] for simple fields, or [cc_creator.data.value.path.to.field] with dot notation for nested JSON paths. Objects/arrays are converted to JSON, strings are unquoted."
    },
    {
      "type": "richtext",
      "id": "header",
      "label": "Header",
      "default": "<h2>Carefully Crafted by [cc-creator-first-name]</h2>",
      "info": "Main heading for the section. Use rich text formatting to style as desired. Supports dynamic text: use [cc-creator-first-name] for simple fields, or [cc_creator.data.value.path.to.field] with dot notation for nested JSON paths. Objects/arrays are converted to JSON, strings are unquoted."
    },
    {
      "type": "range",
      "id": "header_max_width",
      "min": 200,
      "max": 1200,
      "step": 50,
      "unit": "px",
      "label": "Header max width",
      "default": 800,
      "info": "Maximum width of the header text container"
    },
    {
      "type": "range",
      "id": "description_max_width",
      "min": 200,
      "max": 1200,
      "step": 50,
      "unit": "px",
      "label": "Description max width",
      "default": 600,
      "info": "Maximum width of the drop description text"
    },
    {
      "type": "select",
      "id": "description_display_style",
      "label": "Display descriptions as",
      "options": [
        {
          "value": "regular",
          "label": "Regular descriptions"
        },
        {
          "value": "quote_first_name",
          "label": "Quotes from first name"
        },
        {
          "value": "quote_shop_title",
          "label": "Quotes from shop title"
        }
      ],
      "default": "regular",
      "info": "Choose how to display drop descriptions. Quote styles add quotation marks and attribution."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Add Bundle to Cart",
      "info": "Text displayed on the add to cart button. Supports dynamic text: use [cc-creator-first-name] for simple fields, or [cc_creator.data.value.path.to.field] with dot notation for nested JSON paths. Objects/arrays are converted to JSON, strings are unquoted."
    },
    {
      "type": "select",
      "id": "no_drops_behavior",
      "label": "When No Drops Available",
      "options": [
        {
          "value": "hide",
          "label": "Hide section"
        },
        {
          "value": "fallback",
          "label": "Show a fallback collection"
        }
      ],
      "default": "hide",
      "info": "Choose whether to hide the section or show a fallback collection when creator has no drops"
    },
    {
      "type": "collection",
      "id": "fallback_collection",
      "label": "Fallback Collection",
      "info": "Collection to display when no drops are available (only used if 'Show a fallback collection' is selected above)"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 1,
      "max": 50,
      "step": 1,
      "label": "Products To Show (Fallback)",
      "default": 12,
      "info": "Number of products to display from the fallback collection"
    },
    {
      "type": "liquid",
      "id": "product_card_snippet",
      "label": "Product Card Snippet",
      "info": "Custom Liquid code for each product card. Variables: 'product' (Shopify object), 'display_price', 'display_compare_price', 'has_creator_discount'. For drops, 'json_product' includes variant ID. Use any Liquid syntax. Dawn: {% render 'card-product', card_product: product, media_aspect_ratio: 'square' %}"
    },
    {
      "type": "header",
      "content": "Design & Styling",
      "info": "Customize colors, layout, product cards, dropdown styling, spacing, and visual appearance"
    },
    {
      "type": "range",
      "id": "product_card_border_radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Default Product Card Border Radius",
      "default": 0,
      "info": "Border radius for default product card images (only applies when not using a custom product card snippet)"
    },
    {
      "type": "range",
      "id": "dropdown_border_width",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Dropdown Border Width",
      "default": 1
    },
    {
      "type": "range",
      "id": "dropdown_border_radius",
      "min": 0,
      "max": 45,
      "step": 1,
      "unit": "px",
      "label": "Dropdown Border Radius",
      "default": 12
    },
    {
      "type": "select",
      "id": "content_alignment",
      "label": "Content Alignment",
      "options": [
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "left",
          "label": "Left"
        }
      ],
      "default": "center",
      "info": "Align all content and text to the center or left of the section"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    },
    {
      "type": "color",
      "id": "dropdown_border_color",
      "label": "Dropdown Border Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Number Of Columns On Desktop",
      "default": 4
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "label": "Number Of Columns On Mobile",
      "default": 2
    },
    {
      "type": "range",
      "id": "grid_gap_desktop",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Product Grid Gap (Desktop)",
      "default": 20,
      "info": "Space between products on desktop"
    },
    {
      "type": "range",
      "id": "grid_gap_mobile",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Product Grid Gap (Mobile)",
      "default": 12,
      "info": "Space between products on mobile"
    },
    {
      "type": "range",
      "id": "padding_horizontal_desktop",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Horizontal Padding (Desktop)",
      "default": 0,
      "info": "Left and right padding for the section content on desktop"
    },
    {
      "type": "range",
      "id": "padding_horizontal_mobile",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Horizontal Padding (Mobile)",
      "default": 0,
      "info": "Left and right padding for the section content on mobile"
    },
    {
      "type": "range",
      "id": "padding_vertical",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Vertical Padding (Top & Bottom)",
      "default": 36,
      "info": "Top and bottom padding for the section. On mobile, this value is automatically reduced by 25%."
    },
    {
      "type": "header",
      "content": "Advanced Settings",
      "info": "Preview functionality and custom styling options"
    },
    {
      "type": "metaobject",
      "id": "preview_creator",
      "label": "Preview any Creator",
      "info":"Any any creator to preview this section with. Helpful for seeing how different data responds & looks in the section. This will not be seen on the live site.",
      "metaobject_type": "creator"
    },
    {
      "type": "textarea",
      "id": "custom_css",
      "label": "Custom CSS",
      "info": "Enter valid CSS code to customize this section's appearance. Example: #shopify-section-{{ section.id }} .cc-main-title { color: #ff0000; }"
    }
  ],
  "presets": [
    { 
      "name": "Products - Curated Lists"
    }
  ]
}
{% endschema %}

