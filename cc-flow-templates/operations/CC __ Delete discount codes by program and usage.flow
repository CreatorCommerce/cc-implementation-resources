909d072966efd9b861d5f3526530f81fa7cb4f7319c8c43fbbfcee200c7bd3af:{"__metadata":{"version":0.1},"root":{"steps":[{"step_id":"a0c52880-8fdc-4abc-b417-813cdbd06d31","step_position":[0,0],"config_field_values":[],"task_id":"fa0550f6-ef7d-4210-b6d8-6c42169e5f86","task_version":"1.0","task_type":"TRIGGER","description":null,"note":null,"name":null},{"step_id":"4a765d31-c095-46cc-872f-d0cc38d42b9e","step_position":[0,340],"config_field_values":[{"config_field_id":"type","value":"creator"},{"config_field_id":"handle","value":"{{ccCreatorShopHandle}}"}],"task_id":"shopify::flow::fetch::metaobject","task_version":"v1","task_type":"ACTION","description":"Gets CC object","note":null,"name":"Get metaobject entry"},{"step_id":"f4d566c1-8996-4223-97a4-5d460d8973d3","step_position":[0,440],"config_field_values":[{"config_field_id":"input","value":"query{\n  getMetaobjectEntry{\n    data\n  }\n}"},{"config_field_id":"script","value":"export default function main(input) {\n  const parsed =\n    typeof input.getMetaobjectEntry.data === \"string\"\n      ? JSON.parse(input.getMetaobjectEntry.data)\n      : input.getMetaobjectEntry.data;\n\n  const collabId = parsed[\"cc-collab-id\"];\n  const collabTier = parsed[\"cc-collab-tier\"];\n  const customerId = parsed[\"cc-creator-customer\"];\n  const discountCode = parsed[\"cc-collab-discount-code\"];\n\n  return {\n      customerId: customerId,\n    collabId: collabId,\n    collabTier: collabTier,\n    discountCode: discountCode\n  };\n}"},{"config_field_id":"output_schema","value":"\"The output of Run Code\"\ntype Output {\n  collabId: String!\n  customerId: String\n  collabTier: String!\n  discountCode: String\n}"}],"task_id":"shopify::flow::run_code","task_version":"0.1","task_type":"ACTION","description":"Creates CC variables","note":null,"name":"Run code"},{"step_id":"34c815e2-7817-4ba9-92dc-7137b2aae38f","step_position":[0,700],"config_field_values":[{"config_field_id":"sort_by","value":"{\"sortKey\":\"CREATED_AT\",\"order\":\"ASCENDING\"}"},{"config_field_id":"max_root_records","value":"100"},{"config_field_id":"query","value":"customer_id:{{runCode.customerId}} AND discount_code:{{runCode.discountCode}}"}],"task_id":"shopify::flow::fetch::orders","task_version":"v1","task_type":"ACTION","description":"Gets any orders with discount code","note":null,"name":"Get order data"},{"step_id":"e125df03-7f3f-432c-9f58-a81ea151b701","step_position":[0,200],"config_field_values":[{"config_field_id":"wait_duration","value":"{\"amount\":\"2\",\"unit\":\"seconds\"}"}],"task_id":"shopify::flow::wait","task_version":"0.1","task_type":"WAIT","description":null,"note":null,"name":null},{"step_id":"c8296412-d768-4960-bbbe-970a957e71ce","step_position":[0,540],"config_field_values":[{"config_field_id":"condition","value":"{\"uuid\":\"01KGRGR7R686T0C7ANJ6KMSQ6R\",\"lhs\":{\"uuid\":\"01KGRGR7R6ZTT0MJS7KVBQ0F3C\",\"parent_uuid\":\"01KGRGR7R686T0C7ANJ6KMSQ6R\",\"lhs\":{\"uuid\":\"01KGRGR7R6EHZ902EVMBE1ND75\",\"parent_uuid\":\"01KGRGR7R6ZTT0MJS7KVBQ0F3C\",\"value\":\"runCode.collabTier\",\"comparison_value_type\":\"EnvironmentValue\",\"full_environment_path\":\"runCode.collabTier\"},\"rhs\":{\"uuid\":\"01KGRHM4X818DK6H4S09GKE6VH\",\"parent_uuid\":\"01KGRGR7R6ZTT0MJS7KVBQ0F3C\",\"value\":\"NAME\",\"comparison_value_type\":\"LiteralValue\"},\"value_type\":\"EnvironmentScalarDefinition:String\",\"operator\":\"==\",\"operation_type\":\"Comparison\"},\"operator\":\"AND\",\"operation_type\":\"LogicalExpression\"}"}],"task_id":"shopify::flow::condition","task_version":"0.1","task_type":"CONDITION","description":"Runs any tier checks","note":null,"name":null},{"step_id":"dcffd503-28f2-42ce-828c-d0513a4c0fdf","step_position":[0,1000],"config_field_values":[{"config_field_id":"sort_by","value":"{\"sortKey\":\"CREATED_AT\",\"order\":\"DESCENDING\"}"},{"config_field_id":"max_root_records","value":"10"},{"config_field_id":"query","value":"{{runCode.discountCode}}"}],"task_id":"shopify::flow::fetch::discounts","task_version":"v1","task_type":"ACTION","description":"Gets discount data","note":null,"name":"Get discount data"},{"step_id":"14405145-631c-441f-a5b1-1947dd080005","step_position":[0,1500],"config_field_values":[{"config_field_id":"api_call","value":"{\"name\": \"discountCodeBasicUpdate\", \"blob\": \"{\\\"id\\\": \\\"{{getDiscountDataForeachitem.id}}\\\", \\\"basicCodeDiscount\\\": {\\\"endsAt\\\": \\\"2020-01-01T00:00:00Z\\\"}}\"}"}],"task_id":"shopify::admin::admin_api_operation","task_version":"0.1","task_type":"ACTION","description":"Updates to no longer available","note":null,"name":"Disable discount code"},{"step_id":"b2ee01c3-5f13-4573-afa4-39d0675c55c4","step_position":[0,860],"config_field_values":[{"config_field_id":"condition","value":"{\"uuid\":\"01KGRGR7YG55PX7K2SBRG4CKH0\",\"lhs\":{\"uuid\":\"01KGRGR7YGA610MGKSB6BSGAR2\",\"parent_uuid\":\"01KGRGR7YG55PX7K2SBRG4CKH0\",\"array_path\":{\"uuid\":\"01KGRGR7YGY1RCB1JGM6D8MC58\",\"parent_uuid\":\"01KGRGR7YGA610MGKSB6BSGAR2\",\"value\":\"getOrderData\",\"comparison_value_type\":\"EnvironmentValue\",\"full_environment_path\":\"getOrderData\"},\"array_item_key\":{\"uuid\":\"01KGRGR7YGC412WXW8PNJHZJSG\",\"parent_uuid\":\"01KGRGR7YGA610MGKSB6BSGAR2\",\"value\":\"getOrderData_item\",\"comparison_value_type\":\"EnvironmentValue\"},\"operation\":{\"uuid\":\"01KGRGR7YF0TNH32QER27KEK3Q\",\"parent_uuid\":\"01KGRGR7YGA610MGKSB6BSGAR2\",\"lhs\":{\"uuid\":\"01KGRGR7YGVSNA1GXDPCMBH16N\",\"parent_uuid\":\"01KGRGR7YF0TNH32QER27KEK3Q\",\"value\":\"getOrderData_item.id\",\"comparison_value_type\":\"EnvironmentValue\",\"full_environment_path\":\"getOrderData.id\"},\"rhs\":{\"uuid\":\"01KGRGR7YGD59D9WEVTT1NAS55\",\"parent_uuid\":\"01KGRGR7YF0TNH32QER27KEK3Q\",\"value\":\"\",\"comparison_value_type\":\"LiteralValue\"},\"value_type\":\"EnvironmentScalarDefinition:ID\",\"operator\":\"not_empty_and_not_nil?\",\"operation_type\":\"Comparison\"},\"operator\":\"ANY\",\"operation_type\":\"ArrayExpression\"},\"operator\":\"AND\",\"operation_type\":\"LogicalExpression\"}"}],"task_id":"shopify::flow::condition","task_version":"0.1","task_type":"CONDITION","description":"Checks if there's any orders","note":null,"name":null},{"step_id":"32ea32ff-9c8c-48b8-8542-a4e134da8bc5","step_position":[0,1180],"config_field_values":[{"config_field_id":"condition","value":"{\"uuid\":\"01KGRGR85KYDPETRE929GFQ5ER\",\"lhs\":{\"uuid\":\"01KGRGR85KBV5ZG5H2FVAV3ZXP\",\"parent_uuid\":\"01KGRGR85KYDPETRE929GFQ5ER\",\"array_path\":{\"uuid\":\"01KGRGR85K0GHMV3EJ7K3K9YZA\",\"parent_uuid\":\"01KGRGR85KBV5ZG5H2FVAV3ZXP\",\"value\":\"getDiscountData\",\"comparison_value_type\":\"EnvironmentValue\",\"full_environment_path\":\"getDiscountData\"},\"array_item_key\":{\"uuid\":\"01KGRGR85K2KS6J537M9DTECSF\",\"parent_uuid\":\"01KGRGR85KBV5ZG5H2FVAV3ZXP\",\"value\":\"getDiscountData_item\",\"comparison_value_type\":\"EnvironmentValue\"},\"operation\":{\"uuid\":\"01KGRGR85KJYRV0NF0VRM0DM2T\",\"parent_uuid\":\"01KGRGR85KBV5ZG5H2FVAV3ZXP\",\"lhs\":{\"uuid\":\"01KGRGR85MDPGDM408RW656FGW\",\"parent_uuid\":\"01KGRGR85KJYRV0NF0VRM0DM2T\",\"value\":\"getDiscountData_item.id\",\"comparison_value_type\":\"EnvironmentValue\",\"full_environment_path\":\"getDiscountData.id\"},\"rhs\":{\"uuid\":\"01KGRGR85KR3WF3WJE1V4PS7P2\",\"parent_uuid\":\"01KGRGR85KJYRV0NF0VRM0DM2T\",\"value\":\"\",\"comparison_value_type\":\"LiteralValue\"},\"value_type\":\"EnvironmentScalarDefinition:ID\",\"operator\":\"not_empty_and_not_nil?\",\"operation_type\":\"Comparison\"},\"operator\":\"ANY\",\"operation_type\":\"ArrayExpression\"},\"operator\":\"AND\",\"operation_type\":\"LogicalExpression\"}"}],"task_id":"shopify::flow::condition","task_version":"0.1","task_type":"CONDITION","description":"Checks if there's any discounts","note":null,"name":null},{"step_id":"7cd9525b-0be9-41c4-86cb-6dfce8352120","step_position":[0,1340],"config_field_values":[{"config_field_id":"listpath","value":"getDiscountData"}],"task_id":"shopify::flow::foreach","task_version":"0.1","task_type":"FOREACH","description":"Loops any discounts","note":null,"name":null}],"links":[{"from_step_id":"4a765d31-c095-46cc-872f-d0cc38d42b9e","from_port_id":"output","to_step_id":"f4d566c1-8996-4223-97a4-5d460d8973d3","to_port_id":"input"},{"from_step_id":"a0c52880-8fdc-4abc-b417-813cdbd06d31","from_port_id":"output","to_step_id":"e125df03-7f3f-432c-9f58-a81ea151b701","to_port_id":"input"},{"from_step_id":"e125df03-7f3f-432c-9f58-a81ea151b701","from_port_id":"output","to_step_id":"4a765d31-c095-46cc-872f-d0cc38d42b9e","to_port_id":"input"},{"from_step_id":"c8296412-d768-4960-bbbe-970a957e71ce","from_port_id":"false","to_step_id":"34c815e2-7817-4ba9-92dc-7137b2aae38f","to_port_id":"input"},{"from_step_id":"34c815e2-7817-4ba9-92dc-7137b2aae38f","from_port_id":"output","to_step_id":"b2ee01c3-5f13-4573-afa4-39d0675c55c4","to_port_id":"input"},{"from_step_id":"b2ee01c3-5f13-4573-afa4-39d0675c55c4","from_port_id":"false","to_step_id":"dcffd503-28f2-42ce-828c-d0513a4c0fdf","to_port_id":"input"},{"from_step_id":"f4d566c1-8996-4223-97a4-5d460d8973d3","from_port_id":"output","to_step_id":"c8296412-d768-4960-bbbe-970a957e71ce","to_port_id":"input"},{"from_step_id":"dcffd503-28f2-42ce-828c-d0513a4c0fdf","from_port_id":"output","to_step_id":"32ea32ff-9c8c-48b8-8542-a4e134da8bc5","to_port_id":"input"},{"from_step_id":"32ea32ff-9c8c-48b8-8542-a4e134da8bc5","from_port_id":"true","to_step_id":"7cd9525b-0be9-41c4-86cb-6dfce8352120","to_port_id":"input"},{"from_step_id":"7cd9525b-0be9-41c4-86cb-6dfce8352120","from_port_id":"loop_body","to_step_id":"14405145-631c-441f-a5b1-1947dd080005","to_port_id":"input"}],"patched_fields":[{"id":"01KGRGR7C37ANPBYZS0T2R8ATS","handle":"ccChannelBrandkitDescription","field":"ccChannelBrandkitDescription","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-channel-brandkit-description\"}","merchant_configured":false},{"id":"01KGRGR7C364WWK6133E5500HE","handle":"ccChannelBrandkitPrimaryColor","field":"ccChannelBrandkitPrimaryColor","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-channel-brandkit-primary-color\"}","merchant_configured":false},{"id":"01KGRGR7C3K4BAWAZP5A27M5VQ","handle":"ccChannelBrandkitPrimaryLogo","field":"ccChannelBrandkitPrimaryLogo","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-channel-brandkit-primary-logo\"}","merchant_configured":false},{"id":"01KGRGR7C3A04BR4BSQ6MPDQR6","handle":"ccChannelBrandkitTitle","field":"ccChannelBrandkitTitle","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-channel-brandkit-title\"}","merchant_configured":false},{"id":"01KGRGR7C3XV11QY7DD3RE3RVF","handle":"ccCollabAffiliateCode","field":"ccCollabAffiliateCode","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-collab-affiliate-code\"}","merchant_configured":false},{"id":"01KGRGR7C35GXA3SG3DP2B0PRP","handle":"ccCollabAffiliateLink","field":"ccCollabAffiliateLink","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-collab-affiliate-link\"}","merchant_configured":false},{"id":"01KGRGR7C31JK7F91FXQWKY4GC","handle":"ccCollabDiscountAmount","field":"ccCollabDiscountAmount","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-collab-discount-amount\"}","merchant_configured":false},{"id":"01KGRGR7C39M816FB0YGGP7C28","handle":"ccCollabDiscountCode","field":"ccCollabDiscountCode","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-collab-discount-code\"}","merchant_configured":false},{"id":"01KGRGR7C3N0YM8Y4NTQH525M9","handle":"ccCollabDiscountType","field":"ccCollabDiscountType","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-collab-discount-type\"}","merchant_configured":false},{"id":"01KGRGR7C3AJX1Q1QVEQ0SY2W6","handle":"ccCreatorCollection","field":"ccCreatorCollection","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-collection\"}","merchant_configured":false},{"id":"01KGRGR7C3H3XZPYDV6W5N15E7","handle":"ccCreatorDrops","field":"ccCreatorDrops","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-drops\"}","merchant_configured":false},{"id":"01KGRGR7C3GZZ9EHQHFDFVPXRE","handle":"ccCreatorFirstName","field":"ccCreatorFirstName","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-first-name\"}","merchant_configured":false},{"id":"01KGRGR7C33M7JW7C06QM36BM2","handle":"ccCreatorLastName","field":"ccCreatorLastName","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-last-name\"}","merchant_configured":false},{"id":"01KGRGR7C39BECVCHXTRTTF4KQ","handle":"ccCreatorProducts","field":"ccCreatorProducts","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-products\"}","merchant_configured":false},{"id":"01KGRGR7C3PS8GHKKQTBVKJZDS","handle":"ccCreatorProfilePicture","field":"ccCreatorProfilePicture","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-profile-picture\"}","merchant_configured":false},{"id":"01KGRGR7C3BZX91DAAS975CQM7","handle":"ccCreatorShopDescription","field":"ccCreatorShopDescription","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-shop-description\"}","merchant_configured":false},{"id":"01KGRGR7C334979130EH9QX183","handle":"ccCreatorShopHandle","field":"ccCreatorShopHandle","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-shop-handle\"}","merchant_configured":false},{"id":"01KGRGR7C30KCJ4QJJZK0K80QH","handle":"ccCreatorShopThemePrimaryColor","field":"ccCreatorShopThemePrimaryColor","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-shop-theme-primary-color\"}","merchant_configured":false},{"id":"01KGRGR7C3GC10PKW5R5R05N3P","handle":"ccCreatorShopTitle","field":"ccCreatorShopTitle","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"cc-creator-shop-title\"}","merchant_configured":false},{"id":"01KGRGR7C3W5ZMH3GVWFYM8JK7","handle":"data","field":"data","patched_type":"metaobject_11071291641","arguments":"{\"key\":\"data\"}","merchant_configured":false}],"variables":[],"note":null,"vertical_layout_enabled":true,"workflow_name":"CC // Delete discount codes by program and usage"}}